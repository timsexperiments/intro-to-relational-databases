# Homework 14: Window Functions

## Objectives

- Apply window functions to analyze library data
- Use ranking and aggregate windows over partitions
- Experiment with frame clauses for moving calculations

## Instructions

Write a SQL script (`hw14.sql`) that answers the following questions using the existing **library schema**. Include a comment with the question number and a brief description before each answer.

### Questions

1. **Checkout Order Ranking**
   - For each member, list their checkouts ordered by `checkout_date`.
   - Add `ROW_NUMBER` to show the sequence of each checkout per member.

2. **Top Rated Books**
   - Calculate the average rating for each book using a window function.
   - Return books ranked by average rating (highest first) using `RANK`.

3. **Running Checkout Totals**
   - For every member, produce a running total of checkouts over time using `COUNT` with `OVER`.
   - Show member name, checkout date, and running count.

4. **Moving Average Ratings**
   - For each book, compute a 3-review moving average of ratings based on `created_at`.
   - Hint: `ROWS BETWEEN 2 PRECEDING AND CURRENT ROW`.

5. **Percent of Total Checkouts**
   - Use a window function to find each memberâ€™s percentage of all checkouts.
   - Return member name, total checkouts, and percentage.

## Submission

- Save your SQL queries in a file named `hw14.sql`.
- Place the file in: `submissions/homework_14/<your-github-username>/`.
- Submit a pull request as described in the [submissions README](../submissions/README.md).

## Example Directory Structure

```
submissions/
  homework_14/
    your-github-username/
      hw14.sql
```

## Tips

- Use comments (`--`) to label each query.
- Reuse window function patterns across questions.
- Verify results with sample data before submitting.
